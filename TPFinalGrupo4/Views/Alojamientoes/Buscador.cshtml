@model IEnumerable<TPFinalGrupo4.Models.Alojamiento>

@{ ViewData["Title"] = "Buscador"; }
@inject LanguageService language

<form asp-controller="Alojamientoes" asp-action="Buscador" method="get">
    <div class="row pt-4">
        <div class="col-12">
            <h1 class="text-center display-4">@language.Getkey("Buscador")</h1>
        </div>
    </div>

    <div class="row">
        <div class="col-4">
            @language.Getkey("Ciudad")<input class="form-control" list="browsersa" name="searchCiudad" id="searchCiudad" />
            <datalist id="browsersa">
                <option value="Neuquen"></option>
                <option value="Buenos Aires"></option>
                <option value="Carlos Paz"></option>
            </datalist>

        </div>
        <div class="col-4">
            @language.Getkey("Tipo")<input class="form-control" list="browserse" name="searchTipo" />
            <datalist id="browserse">
                <option value="hotel"></option>
                <option value="cabaña"></option>
            </datalist>
        </div>
        <div class="col-2 align-self-end">
            <input type="submit" value="@language.Getkey("Buscar")" class="btn btn-success px-4" />
        </div>
    </div>

</form>

@*empieza*@


<form asp-controller="Alojamientoes" asp-action="Reservar" method="get" id="formulario-reserva">
    <div asp-validation-summary="ModelOnly" class="text-danger"></div>

    <div class="row py-2">
        <div class="form-group col-md-6">
            <label for="fechaDesde" class="control-label">@language.Getkey("Fecha Desde")</label>
            <input type="date" class="form-control" name="fechaDesde" id="fechaDesde" max="2021-12-31" required />
        </div>

        <div class="form-group col-md-6">
            <label for="fechaHasta" class="control-label">@language.Getkey("Fecha Hasta")</label>
            <input type="date" class="form-control" name="fechaHasta" id="fechaHasta" max="2021-12-31" required />
        </div>
    </div>
    <div class="row justify-content-start align-items-center">
        @foreach (var item in Model)
            if (true)
            {
                {
<div class="col-4 mb-4">
    <div class="card shadow">
        <form asp-area="" asp-controller="Alojamientoes" asp-action="Reservar">
            <!--<img src="https://picsum.photos/100/100?random=@item.Id" class="card-img-top" alt="...">-->

            <input type="hidden" name="id_alojamiento" value="@item.Id" />
           
            <div class="card-body">
                @if (item.Tipo == "hotel")
                {
                    <img src="~/imgs/hotel.jpg" class="imagenAlojamientos" alt="Imagen de un hotel">
                }
                else
                {
                    <img src="~/imgs/cabania.jpg" class="imagenAlojamientos" alt="Imagen de una cabaña">
                }
                <h5 class="card-title text-capitalize">
                    @Html.DisplayFor(modelItem => item.Tipo)
                </h5>
                <p class="card-text text-capitalize mb-0 pb-0">
                    @language.Getkey("Ciudad"): @item.Ciudad
                </p>
                <p class="card-text text-capitalize mb-0 pb-0">
                    @language.Getkey("Barrio"): @item.Barrio
                </p>
                <p class="card-text mb-0 pb-0">
                    TV @Html.DisplayFor(modelItem => item.Tv) | @Html.DisplayFor(modelItem => item.Estrellas) estrellas
                </p>
                <p class="card-text">
                    @if (item.Tipo == "hotel")
                    {
                        @Html.DisplayFor(modelItem => item.PrecioPorPersona) }
                    else
                    {
                        @Html.DisplayFor(modelItem => item.PrecioPorDia)}
                    <div class="row justify-content-end">
                        <input type="submit" value=@language.Getkey("Reservar") class="btn btn-primary px-3 mr-3" />
                    </div>
            </div>
        </form>
    </div>
</div>}
}
    </div>
</form>

<script type="text/javascript">

    // Fecha actual
    const hoy = moment(new Date()).format('YYYY-MM-DD')

    // Formulario
    const formulario = document.getElementById("formulario-reserva");
    const inputFechaDesde = document.getElementById("fechaDesde")
    const inputFechaHasta = document.getElementById("fechaHasta")
    inputFechaDesde.min = hoy
    inputFechaHasta.min = hoy

    formulario.addEventListener("submit", (e) => {
        e.preventDefault()

        const diasFechaDesde = moment(inputFechaDesde.value).dayOfYear()
        const diasFechaHasta = moment(inputFechaHasta.value).dayOfYear()

        if ((diasFechaHasta - diasFechaDesde) <= 0) {
            alert('Fechas no validas, vuelva a intentarlo')
            formulario.reset()
        } else {
            if (confirm("¿ Desea realizar la reserva ?")) {
                formulario.submit()
            }
        }
    })
</script>
@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
}
@*//finnn*@


